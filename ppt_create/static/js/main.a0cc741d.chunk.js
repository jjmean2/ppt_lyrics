(this["webpackJsonpreact-app"]=this["webpackJsonpreact-app"]||[]).push([[0],[function(t,n,e){},function(t,n,e){"use strict";e.r(n);var r;e(0);function o(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function i(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,n,e){return n&&i(t.prototype,n),e&&i(t,e),t}function a(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function s(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function l(t,n){var e;if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(e=function(t,n){if(t){if("string"===typeof t)return s(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?s(t,n):void 0}}(t))||n&&t&&"number"===typeof t.length){e&&(t=e);var r=0,o=function(){};return{s:o,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,u=!0,a=!1;return{s:function(){e=t[Symbol.iterator]()},n:function(){var t=e.next();return u=t.done,t},e:function(t){a=!0,i=t},f:function(){try{u||null==e.return||e.return()}finally{if(a)throw i}}}}function c(t,n){var e,r=[],o=l(t);try{for(o.s();!(e=o.n()).done;){var i=e.value,u=r[r.length-1];u&&u.length<n?u.push(i):r.push([i])}}catch(a){o.e(a)}finally{o.f()}return r}function f(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,e=t.tag,r=t.lines;return c(r,n).map((function(t){return{tag:e,body:t.join("\n")}}))}!function(t){t[t.withFlowOrder=0]="withFlowOrder",t[t.withBodyOrder=1]="withBodyOrder"}(r||(r={}));var h=function(){function t(n){var e;o(this,t),this.songParts=n,this.title=void 0,this.flow=void 0,this.linkUrl=void 0,this.bodys=[],this.tagBodyMap=new Map,this.bodysWithNoTag=[],this.comments=[];var r,i=l(n);try{for(i.s();!(r=i.n()).done;){var u=r.value;if(u.category===V.title&&(e=void 0,void 0===this.title?this.title=u.lines.join("\n"):this.logDiscard("title",u)),u.category===V.flow&&(e=void 0,void 0===this.flow?this.flow=u.lines.join(" "):this.logDiscard("flow",u," ")),u.category===V.linkUrl&&(e=void 0,void 0===this.linkUrl?this.linkUrl=u.lines.join("\n"):this.logDiscard("linkUrl",u)),u.category===V.tag&&(e=u.lines[0].toUpperCase()||void 0,console.error("set current tag",e),u.lines.length>1&&this.logDiscard("tag",u.lines.slice(1),", ")),u.category===V.body){console.error("current tag for body",e);var a=this.bodys[this.bodys.length-1];a&&e&&a.tag===e?a.lines=a.lines.concat(u.lines):this.bodys.push({tag:e,lines:u.lines})}u.category===V.comment&&this.comments.push(u.lines.join("\n"))}}catch(s){i.e(s)}finally{i.f()}this.bodysWithNoTag=this.bodys.filter((function(t){return void 0===t.tag})),this.tagBodyMap=new Map(this.bodys.flatMap((function(t){var n=t.tag,e=t.lines;return n?[{tag:n,lines:e}]:[]})).map((function(t){return[t.tag,t]})))}return u(t,[{key:"logDiscard",value:function(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"\n";n instanceof Array?console.error("".concat(t," part (").concat(n,") is discarded")):console.error("".concat(t," part (").concat(n.lines.join(e),") is discarded"))}},{key:"toSlideBodyOrder",value:function(){return this.bodys.flatMap((function(t){return f(t)}))}},{key:"toSlideFlowOrder",value:function(){var t=this;if(void 0===this.flow)return this.toSlideBodyOrder();var n=A(this.flow).map((function(t){return t.toUpperCase()})).map((function(n){return n&&t.tagBodyMap.get(n)||n})).flatMap((function(t){return"string"===typeof t?[{tag:t,body:""}]:f(t)})),e=this.bodysWithNoTag.flatMap((function(t){return f(t)}));return n.concat(e)}},{key:"toSlides",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.withFlowOrder;switch(t){case r.withFlowOrder:return this.toSlideFlowOrder();case r.withBodyOrder:default:return this.toSlideBodyOrder()}}},{key:"toString",value:function(){return"\n\t\t\t* title: ".concat(this.title,"\n\t\t\t* flow: ").concat(this.flow,"\n\t\t\t* linkUrl: ").concat(this.linkUrl,"\n\t\t\t* bodys: ").concat(this.bodys.map((function(t){var n=t.tag,e=t.lines;return"[".concat(n,"]\n").concat(e.join("\n"))})).join("\n\n"),"\n\t\t\t* tagBodyMap: ").concat(this.tagBodyMap,"\n\t\t\t* bodysWithNoTag: ").concat(this.bodysWithNoTag,"\n\t\t\t* comments: ").concat(this.comments,"\n\t\t")}}]),t}();function d(t){return t!==String(parseFloat(t))}var y=Object.getOwnPropertyNames?function(t){return Object.getOwnPropertyNames(t).filter((function(n){return t.propertyIsEnumerable(n)&&d(n)}))}:Object.keys?function(t){return Object.keys(t).filter(d)}:function(t){var n=[];for(var e in t)t.hasOwnProperty(e)&&t.propertyIsEnumerable(e)&&d(e)&&n.push(e);return n},p=function(){function t(t){this.enumObj=t,this.keysList=Object.freeze(y(t));for(var n=this.keysList.length,e=new Array(n),r=new Map,o=0;o<n;++o){var i=this.keysList[o],u=t[i];e[o]=u,r.set(u,i),this[o]=Object.freeze([i,u])}this.valuesList=Object.freeze(e),this.keysByValueMap=r,this.size=this.length=n,Object.freeze(this)}return t.prototype.toString=function(){return"[object EnumWrapper]"},t.prototype.keys=function(){var t,n=this,e=0;return(t={next:function(){var t={done:e>=n.length,value:n.keysList[e]};return++e,t}})[Symbol.iterator]=function(){return this},t},t.prototype.values=function(){var t,n=this,e=0;return(t={next:function(){var t={done:e>=n.length,value:n.valuesList[e]};return++e,t}})[Symbol.iterator]=function(){return this},t},t.prototype.entries=function(){var t,n=this,e=0;return(t={next:function(){var t={done:e>=n.length,value:n[e]};return++e,t}})[Symbol.iterator]=function(){return this},t},t.prototype[Symbol.iterator]=function(){return this.entries()},t.prototype.forEach=function(t,n){for(var e=this.length,r=0;r<e;++r){var o=this[r];t.call(n,o[1],o[0],this,r)}},t.prototype.map=function(t,n){for(var e=this.length,r=new Array(e),o=0;o<e;++o){var i=this[o];r[o]=t.call(n,i[1],i[0],this,o)}return r},t.prototype.getKeys=function(){return this.keysList.slice()},t.prototype.getValues=function(){return this.valuesList.slice()},t.prototype.getEntries=function(){return Array.prototype.slice.call(this)},t.prototype.indexOfKey=function(t){return this.keysList.indexOf(t)},t.prototype.indexOfValue=function(t){return this.valuesList.indexOf(t)},t.prototype.isKey=function(t){return null!=t&&d(t)&&this.enumObj.hasOwnProperty(t)},t.prototype.asKeyOrThrow=function(t){if(this.isKey(t))return t;throw new Error("Unexpected key: "+t+". Expected one of: "+this.getValues())},t.prototype.asKeyOrDefault=function(t,n){return this.isKey(t)?t:n},t.prototype.isValue=function(t){return null!=t&&this.keysByValueMap.has(t)},t.prototype.asValueOrThrow=function(t){if(this.isValue(t))return t;throw new Error("Unexpected value: "+t+". Expected one of: "+this.getValues())},t.prototype.asValueOrDefault=function(t,n){return this.isValue(t)?t:n},t.prototype.getKeyOrThrow=function(t){var n=null!=t?this.keysByValueMap.get(t):void 0;if(null!=n)return n;throw new Error("Unexpected value: "+t+". Expected one of: "+this.getValues())},t.prototype.getKeyOrDefault=function(t,n){var e=null!=t?this.keysByValueMap.get(t):void 0;return null!=e?e:n},t.prototype.getValueOrThrow=function(t){return this.enumObj[this.asKeyOrThrow(t)]},t.prototype.getValueOrDefault=function(t,n){return this.isKey(t)?this.enumObj[t]:n},t}();p.prototype[Symbol.toStringTag]="EnumWrapper";var v=Symbol("ts-enum-util:unhandledEntry"),g=Symbol("ts-enum-util:handleNull"),w=Symbol("ts-enum-util:handleUndefined"),m=Symbol("ts-enum-util:handleUnexpected");function b(t){return new Error("Unhandled value: "+t)}var O=function(){function t(t){this.value=t}return t.prototype.with=function(t){if(t.hasOwnProperty(this.value))return j(t[this.value],this.value);if(t[m])return j(t[m],this.value);throw new Error("Unexpected value: "+this.value)},t}(),k=function(){function t(){}return t.prototype.with=function(t){if(t[g])return j(t[g],null);if(t[m])return j(t[m],null);throw new Error("Unexpected value: null")},t}(),x=function(){function t(){}return t.prototype.with=function(t){if(t[w])return j(t[w],void 0);if(t[m])return j(t[m],void 0);throw new Error("Unexpected value: undefined")},t}();function j(t,n){if(t===v)throw b(n);return t(n)}var U=function(){function t(t){this.value=t}return t.prototype.with=function(t){if(t.hasOwnProperty(this.value))return P(t[this.value],this.value);if(t.hasOwnProperty(m))return P(t[m],this.value);throw new Error("Unexpected value: "+this.value)},t}(),E=function(){function t(){}return t.prototype.with=function(t){if(t.hasOwnProperty(g))return P(t[g],null);if(t.hasOwnProperty(m))return P(t[m],null);throw new Error("Unexpected value: null")},t}(),S=function(){function t(){}return t.prototype.with=function(t){if(t.hasOwnProperty(w))return P(t[w],void 0);if(t.hasOwnProperty(m))return P(t[m],void 0);throw new Error("Unexpected value: undefined")},t}();function P(t,n){if(t===v)throw b(n);return t}var M,V,B=new WeakMap;function C(t){var n=B.get(t);return n||(n=new p(t),B.set(t,n)),n}C.handleNull=g,C.handleUndefined=w,C.handleUnexpected=m,C.unhandledEntry=v,C.visitValue=function(t){return null===t?new k:void 0===t?new x:new O(t)},C.mapValue=function(t){return null===t?new E:void 0===t?new S:new U(t)},function(t){t[t.empty=0]="empty",t[t.linkUrl=1]="linkUrl",t[t.tag=2]="tag",t[t.flow=3]="flow",t[t.title=4]="title",t[t.comment=5]="comment",t[t.body=6]="body",t[t.date=7]="date",t[t.separator=8]="separator",t[t.unknown=9]="unknown"}(V||(V={}));var T=[/^V\d?$/i,/^P?C\d?$/i,/^B\d?$/i,/^E(nding)$/i],$=[].concat(T,[/^x\d$/i,/^\uac04\uc8fc$/]),K=function(t){return $.some((function(n){return n.test(t)}))},A=function(t){return t.split(/[\W_]/).filter((function(t){return/\w/.test(t)}))},D=[/^[-=*][-=* ]+[-=*]$/],F=5,L=0,N=[V.comment,V.title,V.flow,V.linkUrl],W=(a(M={},V.empty,(function(t){return""===t?F:L})),a(M,V.date,(function(t){})),a(M,V.title,(function(t){var n=0;return/^\d./.test(t)&&(n+=2),/\(\w\)$/.test(t)&&(n+=2),/\(\w->\w\)$/.test(t)&&(n+=1),n})),a(M,V.linkUrl,(function(t){return/^https?:\/\/.*$/.test(t)?F:L})),a(M,V.flow,(function(t){var n=A(t);if(1===n.length)return L;var e=n.filter(K);return Math.ceil(5*e.length/n.length)})),a(M,V.tag,(function(t){return n=t,T.some((function(t){return t.test(n)}))?F:/^[A-Z]{,2}\d?$/i.test(t)?3:void 0;var n})),a(M,V.body,(function(t){return/^[\w,"'.)( ]+$/i.test(t)?2:1})),a(M,V.comment,(function(t){return/[\uac00-\ud7a3]+/.test(t)?2:1})),a(M,V.separator,(function(t){return n=t,D.some((function(t){return t.test(n)}))?F:L;var n})),M),I=function t(n){var e;o(this,t),this.text=n,this.inferedCategory=void 0;var r=C(V).getValues();this.inferedCategory=null!==(e=r.reduce((function(t,e){var r;if((null===t||void 0===t?void 0:t.score)===F)return t;var o=W[e],i=null===o||void 0===o?void 0:o(n);return void 0!==i&&i>(null!==(r=null===t||void 0===t?void 0:t.score)&&void 0!==r?r:-1)?{value:e,score:i}:t}),void 0))&&void 0!==e?e:{value:V.unknown,score:5}},z=function(){function t(n){o(this,t),this.lines=void 0,this.songsCache=void 0,this.done=!1,this.lines=n.trim().split("\n").map((function(t){return t.trim()})).reduce((function(t,n){var e,r=null!==(e=t[t.length-1])&&void 0!==e?e:"";return""===n&&""===r.text||t.push(new I(n)),t}),[])}return u(t,[{key:"songs",value:function(){if(this.songsCache)return this.songsCache;for(var t=this.getSongParts(),n=[],e=0;-1!==e&&e<t.length;){var r=t[e];if(r.category===V.separator){var o=t.slice(0,e);if(J(o)){n.push(o),t.splice(0,e),e=1;continue}}else if(N.includes(r.category)){if("continue"===function(){var o,i=t.slice(e).findIndex((function(t){return t.category===V.body})),u=-1!==i?e+i:void 0;if(console.error("current",r.lines,"firstbody",null===(o=t[null!==u&&void 0!==u?u:-1])||void 0===o?void 0:o.lines),void 0!==u){var a=function(){var n=t.slice(e,u).map((function(t){return t.category}));return console.error("categories",n.map((function(t){return C(V).getKeyOrDefault(t)}))),n.includes(V.title)||n.includes(V.flow)||n.includes(V.linkUrl)}();if(console.error("is title section",a,"\n"),a){var s=t.slice(0,e);return J(s)&&(n.push(s),t.splice(0,e)),console.error("current index",e,"->",i),e=i,"continue"}return console.error("current index",e,"->",u),e=i,"continue"}}())continue}e+=1}return J(t)&&n.push(t),this.songsCache=n.map((function(t){return new h(t)})),this.songsCache}},{key:"getSongParts",value:function(){var t=this,n=[];return this.lines.forEach((function(t,e){var r=n[n.length-1];void 0===r?n.push({start:e,category:t.inferedCategory.value}):r.category!==t.inferedCategory.value&&(r.end=e,n.push({start:e,category:t.inferedCategory.value}))})),n[n.length-1]&&(n[n.length-1].end=this.lines.length),n.flatMap((function(n){var e=n.start,r=n.end,o=n.category;return void 0===r?[]:[{start:e,end:r,category:o,lines:t.lines.slice(e,r).map((function(t){return t.text}))}]}))}}]),t}();function J(t){return t.filter((function(t){return t.category===V.body})).length>0}function Z(t){var n=t.tag,e=t.body;return["[[".concat(null!==n&&void 0!==n?n:"","]]"),e||n].join("\n")}function _(t){return t.map(Z).join("\n---\n")}var q=function(){function t(n){o(this,t),this.lineParser=void 0,this.songParsers=void 0,this.lineParser=new z(n),this.songParsers=this.lineParser.songs()}return u(t,[{key:"toFormText",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.withFlowOrder;return this.songParsers.map((function(n){return _(n.toSlides(t))})).join("\n===\n")}}]),t}();window.onload=function(){console.log("On load");var t=document.getElementById("submit-button"),n=document.lyricsform,e=n.lyrics,r=n.body;t.onclick=function(){var t,o=document.createElement("div");null===(t=n.parentElement)||void 0===t||t.appendChild(o);var i=new q(e.value);r.value=i.toFormText(),o.textContent=r.value,n.submit()}}}],[[1,1]]]);
//# sourceMappingURL=main.a0cc741d.chunk.js.map